<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Debug Test</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <div id="output" style="padding: 20px; font-family: Arial, sans-serif;"></div>

    <script>
        const output = document.getElementById('output');
        
        function log(message, type = 'info') {
            const color = type === 'error' ? 'red' : type === 'success' ? 'green' : 'blue';
            output.innerHTML += `<div style="color: ${color}; margin: 5px 0;">[${new Date().toLocaleTimeString()}] ${message}</div>`;
        }

        async function testDashboard() {
            try {
                log('üîç Testing Dashboard Dependencies...', 'info');
                
                // Test 1: Check Supabase client
                if (typeof supabase === 'undefined') {
                    throw new Error('Supabase client not loaded');
                }
                log('‚úÖ Supabase client loaded', 'success');

                // Test 2: Initialize Supabase
                const SUPABASE_URL = 'https://ppipsveojmbfpsjjcmlt.supabase.co';
                const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBwaXBzdmVvam1iZnBzampjbWx0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAyNTYxNDcsImV4cCI6MjA3NTgzMjE0N30.Dla5hGLU-5FPlbjDp6Bd0zS4yjZjCPlF4qEiVMKj9i4';
                
                const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                log('‚úÖ Supabase client initialized', 'success');

                // Test 3: Try to fetch data
                log('üì° Connecting to database...', 'info');
                const { data, error } = await supabaseClient
                    .from('items')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) {
                    throw new Error(`Database error: ${error.message}`);
                }

                log(`‚úÖ Database connected successfully! Found ${data.length} items`, 'success');
                
                // Test 4: Show item details
                if (data.length > 0) {
                    log('üìã Sample items:', 'info');
                    data.slice(0, 3).forEach((item, index) => {
                        log(`${index + 1}. ${item.name} (${item.status}) - ${item.photo_url ? 'Has photo' : 'No photo'}`, 'info');
                    });
                } else {
                    log('‚ÑπÔ∏è No items found in database', 'info');
                }

                log('üéâ All tests passed! Dashboard should work.', 'success');

            } catch (error) {
                log(`‚ùå Error: ${error.message}`, 'error');
                log('üîß Possible fixes:', 'info');
                log('- Check internet connection', 'info');
                log('- Verify database credentials', 'info');
                log('- Check if JavaScript files exist', 'info');
            }
        }

        // Run test when page loads
        document.addEventListener('DOMContentLoaded', testDashboard);
    </script>
</body>
</html>